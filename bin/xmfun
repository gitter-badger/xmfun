#!/usr/bin/env ruby

require 'clap'
require 'xmfun'

url = ''
dst = '.'

Clap.run ARGV,
  "-c" => lambda { |collect_id| url = "http://www.xiami.com/song/playlist/id/#{collect_id}/type/3" },
  "-s" => lambda { |song_id| url = "http://www.xiami.com/song/playlist/id/#{song_id}/object_name/default/object_id/0" },
  "-d" => lambda { |d| dst = d },
  "-v" => lambda { puts Xmfun::VERSION },
  "-h" => lambda { puts Xmfun.help }

Xmfun::Downloader.download(url, dst) unless url.empty?
